{% extends "base.html" %}

{% block title %}Quality issues — {{ dataset.original_filename }}{% endblock %}

{% block content %}
<style>
    .report-container {
        position: fixed;
        top: 56px;
        left: 0;
        right: 0;
        bottom: 0;
        padding: 0;
        margin: 0;
    }
    .report-header {
        background: white;
        padding: 15px 0;
        margin-top: 20px;   /* ⬅️ add this */
        border-bottom: 1px solid #dee2e6;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .report-iframe {
        width: 100%;
        height: calc(100vh - 120px);
        border: none;
    }
    body {
        overflow: hidden;
    }

    .btn-light-blue {
        background-color: #a8d0e6 !important;
        color: white !important;
        border: none !important;
        padding: 0.375rem 0.75rem !important;
        border-radius: 0.375rem !important;
        transition: all 0.1s ease !important;
    }

    .btn-light-blue .bi {
        color: white !important;
    }
</style>

<div class="qi-wrap">
  <div class="d-flex justify-content-between align-items-center mb-2">
    <h3 class="mb-0">Quality issues — {{ dataset.original_filename }}</h3>
    <a href="{{ url_for('view_profile', dataset_id=dataset.id) }}" class="btn btn-outline-secondary btn-sm">
      Back to profile
    </a>
  </div>

  <div class="qi-card">
    <h5 class="qi-h">1) Missing values</h5>
    <div class="table-responsive">{{ missing_html|safe }}</div>
  </div>

  <div class="qi-card">
    <h5 class="qi-h">2) Duplicate rows</h5>
    <div class="mb-2"><strong>Summary</strong></div>
    <div class="table-responsive">{{ dup_summary_html|safe }}</div>
    <div class="mt-3 mb-2"><strong>Largest duplicate groups</strong></div>
    <div class="table-responsive">{{ dup_groups_html|safe }}</div>
  </div>

  <div class="qi-card">
    <h5 class="qi-h">3) Outliers</h5>
    <div class="mb-2"><strong>Per-column counts</strong></div>
    <div class="table-responsive">{{ out_counts_html|safe }}</div>
    <div class="mt-3 mb-2"><strong>Rows flagged (top 50)</strong></div>
    <div class="table-responsive">{{ out_rows_html|safe }}</div>
  </div>

  <div class="qi-card">
    <h5 class="qi-h">4) Labeling issues (categorical)</h5>
    <div class="table-responsive">{{ labels_html|safe }}</div>
  </div>
</div>
{% endblock %}